{% extends 'base.html.twig' %}

{% block title %}Mes Factures{% endblock %}

{% block body %}
<main class="bg-black text-white py-5" style="min-height:100vh;">
  <div class="container" style="max-width:1100px;">
    <h1 class="h3 text-accent mb-4">Mes Factures</h1>

    <p class="text-muted mb-3">Historique de vos commandes liées aux enchères remportées.</p>

    {% if orders is empty %}
      <p class="text-center text-muted fst-italic mb-0">Aucune facture disponible pour le moment.</p>
    {% else %}
      <div class="table-responsive">
        <table class="table table-dark table-striped align-middle border-secondary">
          <thead>
            <tr>
              <th>N° Commande</th>
              <th>Date</th>
              <th>Total</th>
              <th>Statut</th>
            </tr>
          </thead>
          <tbody>
          {% for order in orders %}
            <tr>
              <td>#{{ order.reference ?? order.id }}</td>
              <td>{{ order.createdAt ? order.createdAt|date('d/m/Y H:i','Europe/Paris') : '' }}</td>
              <td>{{ order.total is defined ? order.total|number_format(2, ',', ' ') : '0,00' }} €</td>
              <td>
                {% set status = order.status ?? 'pending' %}
                <span class="badge
                  {% if status == 'paid' %} bg-success
                  {% elseif status == 'pending' %} bg-warning text-dark
                  {% elseif status == 'cancelled' %} bg-danger
                  {% else %} bg-secondary
                  {% endif %}">
                  {{ status|capitalize }}
                </span>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}

    <div class="mt-3">
      <a href="{{ path('app_profil') }}" class="btn btn-outline-light">← Retour au profil</a>
    </div>
  </div>
</main>
{% endblock %}
